function cr8cryst(command,data)% generate .lat file with a gui% this doesn't have all possibilities in it yet.% Copyright 1999 Sean Brennan.% Stanford Synchrotron Radiation Laboratory% Stanford Linear Accelerator Center, Stanford CA 94309% bren@slac.stanford.eduglobal DISK_PATH DISK_END ANOMAL_FILES DISK_DELIMif nargin==0 % initialize window	cryst_i;	return;endif strcmp(command,'write')% write the lat file	crys_name= get(findobj(gcf,'tag','crystal'),'string');	if strcmp(crys_name,'')		disp('  Please enter name of crystal')		break	end	a_zero= str2num(get(findobj(gcf,'tag','a_zero'),'string'));	desc= get(findobj(gcf,'tag','descript'),'string');	STR_LATTICE= [a_zero a_zero a_zero 90 90 90];	STR_T_DEBYE= 370;	STR_TEMP_COEF= 5.2;	STR_STIFF= [11.88 5.37 5.94];      % these are GaAs stiffnesses 19-jun-01 SMB	crys_type= get(findobj(gcf,'tag','crys_type'),'value');	if crys_type==1,	% FCC		STR_ATOMX=[0.0 0.5 0.0 0.5];		STR_ATOMY=[0.0 0.0 0.5 0.5];		STR_ATOMZ=[0.0 0.5 0.5 0.0];		STR_BASIS=1;		STR_SITES=4;		data= get(findobj(gcf,'tag','basis1'),'userdata');		[row,col]=size(data);		STR_ATOMS=row;		STR_ZED=data(:,1);		STR_FRACT=data(:,2);			elseif crys_type==2,	% BCC		STR_ATOMX=[0.0 0.5];		STR_ATOMY=[0.0 0.5];		STR_ATOMZ=[0.0 0.5];		STR_BASIS=1;		STR_SITES=2;		data= get(findobj(gcf,'tag','basis1'),'userdata');			[row,col]=size(data);		STR_ATOMS=row;		STR_ZED=data(:,1);		STR_FRACT=data(:,2);			elseif crys_type==3,	% Diamond Cubic		STR_ATOMX= [0.1250    0.1250    0.6250    0.6250; ...		            0.3750    0.3750    0.8750    0.8750];		STR_ATOMY= [-0.1250    0.3750   -0.1250    0.3750; ...		             0.1250    0.6250    0.1250    0.6250];		STR_ATOMZ= [-0.1250    0.3750    0.3750   -0.1250; ...		            -0.3750    0.1250    0.1250   -0.3750];		base_val= get(findobj(gcf,'tag','bases'),'value');		STR_BASIS=base_val;		STR_SITES=[4 4];		data1= get(findobj(gcf,'tag','basis1'),'userdata');			if base_val==1,			data2= get(findobj(gcf,'tag','basis1'),'userdata');			else			data2= get(findobj(gcf,'tag','basis2'),'userdata');			end		[r1,c1]=size(data1);		[r2,c2]=size(data2);		STR_ATOMS=[r1 r2];		if r1 ~= r2,			if r1>r2,				for i=r2+1:r1,					data2(i,:)= [0 0];				end			else				for i=r1+1:r2,					data1(i,:)= [0 0];				end			end		end		STR_ZED=[data1(:,1)';data2(:,1)'];		STR_FRACT=[data1(:,2)';data2(:,2)'];			elseif crys_type==4,	% NaCl		STR_ATOMX=[0.0 0.5 0.0 0.5;0.0 0.5 0.0 0.5];		STR_ATOMY=[0.0 0.0 0.5 0.5;0.5 0.5 0.0 0.0];		STR_ATOMZ=[0.0 0.5 0.5 0.0;0.0 0.5 0.5 0.0];		STR_BASIS=2;		STR_SITES=4;		data= get(findobj(gcf,'tag','basis1'),'userdata');		[row,col]=size(data);		STR_ATOMS=row;		STR_ZED=data(:,1);		STR_FRACT=data(:,2);			elseif crys_type==5,	% CsCl		STR_ATOMX=[0.0; 0.5];		STR_ATOMY=[0.0; 0.5];		STR_ATOMZ=[0.0; 0.5];		STR_BASIS=2;		STR_SITES=1;		data= get(findobj(gcf,'tag','basis1'),'userdata');			[row,col]=size(data);		STR_ATOMS=row;		STR_ZED=data(:,1);		STR_FRACT=data(:,2);			end	fname= [DISK_PATH,ANOMAL_FILES,DISK_DELIM,'lat_dir',DISK_END,crys_name];	save(fname,'desc','STR_BASIS','STR_SITES','STR_ATOMS','STR_ZED','STR_FRACT',...	'STR_ATOMX','STR_ATOMY','STR_ATOMZ','STR_LATTICE','STR_T_DEBYE','STR_TEMP_COEF',...	'STR_STIFF')	disp(['File ',DISK_PATH,ANOMAL_FILES,DISK_DELIM,'lat_dir',DISK_END,crys_name,'.mat written to disk'])	elseif strcmp(command,'crys_type')	crys_type= get(findobj(gcf,'tag','crys_type'),'value');	if crys_type ==1 | crys_type == 2,		set(findobj(gcf,'tag','bases'),'value',1);		set(findobj(gcf,'tag','basis2'),'visible','off');		set(findobj(gcf,'tag','data2'),'visible','off');	elseif crys_type == 3 | crys_type == 4 | crys_type == 5,		set(findobj(gcf,'tag','basis2'),'visible','on');	end	elseif strcmp(command,'bases')	base_val= get(findobj(gcf,'tag','bases'),'value');	crys_type= get(findobj(gcf,'tag','crys_type'),'value');	if crys_type ==1 | crys_type == 2,		set(findobj(gcf,'tag','bases'),'value',1);		base_val= 1;	end	if base_val==1,		set(findobj(gcf,'tag','basis2'),'visible','off');		set(findobj(gcf,'tag','data2'),'visible','off');	else		set(findobj(gcf,'tag','basis2'),'visible','on');	end	elseif strcmp(command,'bas1')	cr8alloy('Basis1');elseif strcmp(command,'bas2')	cr8alloy('Basis2');elseif strcmp(command,'Basis1')	close(gcf);                              % close current window	figure(findobj(0,'Name','CRYSTAL'))      % make multi figure current	set(findobj(gcf,'tag','basis1'),'userdata',data);	fred=data';	set(findobj(gcf,'tag','data1'),'string',sprintf('%0.3g  ',[fred(:)']));elseif strcmp(command,'Basis2')	close(gcf);                              % close current window	figure(findobj(0,'Name','CRYSTAL'))      % make multi figure current	set(findobj(gcf,'tag','basis2'),'userdata',data);	fred=data';	set(findobj(gcf,'tag','data2'),'string',sprintf('%0.3g  ',[fred(:)']));end