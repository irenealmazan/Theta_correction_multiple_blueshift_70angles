function [fp, fpp] = mcm( zed, energy )% Calculate f' and f'' for H and He%% Usage: [fp, fpp] = mcm( zed, energy )% Fortran version written by Sean Brennan at SSRL, described in% S. Brennan and P.L. Cowan, Rev. Sci. Instrum., 63, 850 (1992).% V3.0 ported to MATLAB, Alex Lessmann (1.0)% Modified to matrix  18-Nov-94 AM,SMBBARNS_TO_ELECTRONS = 1.43110541e-8;% BARNS_TO_ELECTRONS is a constant that converts the cross section in % barns/atom into a cross-section in electrons/atom which is the same % as f''. It is calculated as 1/( 10^8 [b/A^2]*2*r_e=2.8179^-5*hc=12398.52)fp = zeros([1 length(energy)]);fpp = fp;p1 = log( energy./1000 );p2 = p1.^2;p3 = p1.^3;if zed == 1	% Hydrogen	index=find(energy>14e-3);	fpp(index) = BARNS_TO_ELECTRONS .* energy(index) .* ...				 exp( 2.44964 - 3.34953.*p1(index) - ...				 0.047137.*p2(index) + 0.0070996.*p3(index) );else		% Helium	index=find(energy>25e-3);	fpp(index) = BARNS_TO_ELECTRONS .* energy(index) .* ...		         exp( 6.06488 - 3.2905.*p1(index) - ...				 0.107256.*p2(index) + 0.0144465.*p3(index) );end