function noread = rdlat( crys_name )% noread = rdlat( crys_name )% Read lattice file, must be called before STRUCT_F and DSPACE% Sean Brennan, SSRL/SLAC, Bren@slac.stanford.edu 9-Feb-96%  STR_BASIS       % bases in the crystal%  STR_SITES       % number of atomic positions in each basis%  STR_ATOMS       % number of atoms in each basis%  STR_ZED         % atomic number of atoms in each basis%  STR_FRACT       % fraction of each atomic number in each basis%  STR_ATOMX       % x positions of sites in each basis%  STR_ATOMY       % y positions of sites in each basis%  STR_ATOMZ       % z positions of sites in each basis%  STR_LATTICE     % a0,b0,c0,alpha,beta,gamma (Angstroms and degrees)%  STR_T_DEBYE     % Debye temperature (K)%  STR_TEMP_COEF   % linear term in thermal expansion coefficient%  STR_STIFF       % stiffnesses of the crystal%As an example, consider InGaAs, where there is 50%In and 50%Ga%then%  STR_BASIS= 2%  STR_SITES= [4 4]  %4 atoms in each basis%  STR_ATOMS= [2 1]  %2 Atoms in first basis, one in the second%  STR_ZED=   [49 31; 33 0]  % Two atomic numbers in first basis, one in second%  STR_FRACT= [0.5 0.5; 1 0]%  STR_ATOMX= [0.1250    0.1250    0.6250    0.6250; ...%              0.3750    0.3750    0.8750    0.8750]%  STR_ATOMY= [-0.1250    0.3750   -0.1250    0.3750; ...%               0.1250    0.6250    0.1250    0.6250]%  STR_ATOMZ= [-0.1250    0.3750    0.3750   -0.1250; ...%              -0.3750    0.1250    0.1250   -0.3750]%  STR_LATTICE= [5.7335 5.7335 5.7335 90 90 90]%  STR_T_DEBYE= 645%  STR_TEMP_COEF= 5%  STR_STIFF= [16.58 6.39 7.96]%Note that Matlab does know about case sensitivity in variables, and I make%a habit of CAPITALIZING all global variables, which the above are.% Fortran version written by Sean Brennan at SSRL, described in% S. Brennan and P.L. Cowan, Rev. Sci. Instrum., 63, 850 (1992).% V3.0 ported to MATLAB, Alex Lessmann (1.0)% MATLAB compatible 18-NOV-95 SMBglobal  STR_BASIS STR_SITES STR_ATOMS STR_ERGglobal	STR_ZED STR_FRACT STR_ATOMX STR_ATOMY STR_ATOMZglobal	STR_LATTICE STR_T_DEBYE STR_TEMP_COEF STR_STIFFglobal	DISK_PATH DISK_DELIM DISK_END ANOMAL_FILES IS_LOADEDif strcmp(crys_name,IS_LOADED), 	noread= 0;	return;endibasis = 0;filename = [DISK_PATH,ANOMAL_FILES,DISK_DELIM,'lat_dir',DISK_END,crys_name,'.mat'];if exist( filename ) == 2    load(filename)	STR_ERG= 0;    % Tell struct_f to load in new values from atomdata, etc.else	noread= 1;	return		endif nargout == 1,	if length(STR_LATTICE) ~=6,		% test if really a lattice file    	noread = 1;	else	    noread = 0;		IS_LOADED= crys_name;	endelse	if length(STR_LATTICE) ~=6,		% test if really a lattice file    	disp('Error reading file');	else	    disp('File loaded');		IS_LOADED= crys_name;	endendreturn