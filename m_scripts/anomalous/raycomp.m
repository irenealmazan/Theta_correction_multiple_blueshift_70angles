function [ray, comp] = raycomp( zed, energy )% Calculate elastic and compton cross-sections (in electrons/atom)%% Usage: [ray, comp] = raycomp( zed, energy )% Fortran version written by Sean Brennan at SSRL, described in% S. Brennan and P.L. Cowan, Rev. Sci. Instrum., 63, 850 (1992).% V3.0 ported to MATLAB, Alex Lessmann (1.0)% V3.1 vectorized SMB 21-Nov-94% calls to ray_comp.matglobal DISK_PATH DISK_DELIM DISK_END ANOMAL_FILES CL_DRAY CL_DCMPBARNS_TO_ELECTRONS = 1.43110541e-8;% BARNS_TO_ELECTRONS converts the cross section in % barns/atom into a cross-section in electrons/atom which = f''.% It is calculated as BARNS_TO_ELECTRONS = % 1/( 10^8 [b/A^2]*2*rsube = 2.8179^-5*hc = 12398.52 )if isempty( CL_DRAY)    %load([DISK_PATH,ANOMAL_FILES,DISK_DELIM,'crom_dir',DISK_END,'ray_comp']);    load('/Users/shrus/m_scripts/anomalous/data_dir/crom_dir/ray_comp');endif min(energy) <= 0    error( 'Energy must be positive' )elseif( ( zed < 1) | ( zed > 92) )    error( 'Atomic number out of range' )endp1 = log( energy./1000. );p2 = p1.^2;p3 = p1.^3;ray = BARNS_TO_ELECTRONS * energy.* exp( CL_DRAY(zed,1) + ...	CL_DRAY(zed,2) * p1 + CL_DRAY(zed,3) * p2 + CL_DRAY(zed,4) * p3 );comp = BARNS_TO_ELECTRONS * energy.* exp( CL_DCMP(zed,1) + ...	CL_DCMP(zed,2) * p1 + CL_DCMP(zed,3) * p2 + CL_DCMP(zed,4) * p3 );return