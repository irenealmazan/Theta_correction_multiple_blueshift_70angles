function scat_fact = sfwaas( zed, k )% scat_fact = sfwaas( zed, k )% calculate atomic form factor given atomic number and % scattering vector k where k= 4*pi*sin(theta)/lambda% From D. Waasmaier and A. Kirfel, Acta Cryst A51, 416 (1995)% Note that hydrogen is H(minus) ion divided by 2.% S. Brennan & A. Munkholm, 11-Feb-1996 SSRL/SLAC % Bren@slac.stanford.edu; Munkholm@slac.stanford.eduglobal	DISK_PATH DISK_DELIM DISK_END ANOMAL_FILES WAAS_A WAAS_B WAAS_Cif(isempty( 'WAAS_A' ) ~= 1)    load([DISK_PATH,ANOMAL_FILES,DISK_DELIM,'crom_dir',DISK_END,'waaskir']);endif zed < 1 |  zed > 92,    zed = 0;    error( 'Atomic number out of range!' )endif max(k)>75, error('K-value too large!'), endif min(k)<0, error('K-value must be positive!'), end% 0.0063326=(1/4pi)^2 to convert from k to sin(th)/lambdaksqr = -0.0063326 * k(:)'.^2;mort= WAAS_B(zed,:)';scat_fact= sum( (WAAS_A(zed,:)'* ones(size(ksqr))) ...			.* exp(WAAS_B(zed,:)'*ksqr))+ WAAS_C(zed);