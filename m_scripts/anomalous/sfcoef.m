function [scat_fact, compton] = sfcoef( zed, k )% This function calculates f as f(sin(th)/lamda) given zed.% It uses the parametrized fits of Cromer and Mann, Acta Cryst. A24 321 (1968).% The function also calculates the compton component % using the fits of Balyuzi, Acta. Cryst. A31 600 (1975).% k is assumed to be 4pisin(theta)/lambda% and is converted to sin(th)/lambda within the routine.% compton = incoherent portion of scattering factor%% Usage: [scat_fact, compton] = sfcoef( zed, k )% Fortran version written by Sean Brennan at SSRL, described in% S. Brennan and P.L. Cowan, Rev. Sci. Instrum., 63, 850 (1992).% V3.0 ported to MATLAB, Alex Lessmann (1.0)% V3.1 vectorized SMB 11-18-94global	DISK_PATH DISK_DELIM DISK_END ANOMAL_FILES SF_COMP SF_F_INDif( (isempty( 'SF_COMP' ) ~= 1) | (isempty( 'SF_F_IND' ) ~= 1 ) )    %load([DISK_PATH,ANOMAL_FILES,DISK_DELIM,'crom_dir',DISK_END,'sf_coef']);    load('~/m_scripts/anomalous/data_dir/crom_dir/sf_coef.mat');endif zed < 1 |  zed > 92,    zed = 0;    error( 'Atomic number out of range' )endif k > 18.5 | k <0,    zed = 0;    error( 'K value out of range' )end% 0.0063326=(1/4pi)^2 to convert from k to sin(th)/lambdaksqr = -0.0063326 * k(:)'.^2;find_t= reshape(SF_F_IND(zed,1:8),2,4);scat_fact= SF_F_IND(zed,9)+find_t(1,:)*exp(find_t(2,:)'*ksqr);% Now calculate compton componentcomp_t= reshape(SF_COMP(zed,:),2,5);compton= zed- comp_t(1,:)*exp(comp_t(2,:)'*ksqr);return