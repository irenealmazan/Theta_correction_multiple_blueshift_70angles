function [mu, rho_ave] = matlabs( name, energy )% Read material data file and calculate mu%% Usage: [mu, rho_ave] = matlabs( name, energy )% Fortran version written by Sean Brennan at SSRL, described in% S. Brennan and P.L. Cowan, Rev. Sci. Instrum., 63, 850 (1992).% V3.0 ported to MATLAB, Alex Lessmann (1.0)% modified to take advantage of matlab 23-apr-95 SMBF_TO_MU	= 4208.031548;		% Mu in microns[density,zed_fract]=mtl_rd( name);for i =1:size(zed_fract,1)    [fp,fpp(i,:)] = anomal( zed_fract(i,1), energy );    [ray(i,:),comp(i,:)] = raycomp( zed_fract(i,1), energy );    [amu(i,1),rho(i,1)] = atomdata( zed_fract(i,1) );	mu(i,:)= zed_fract(i,2)* (fpp(i,:)+ ray(i,:)+ comp(i,:));endmu = sum( mu);amu_ave = sum( zed_fract(:,2).*amu);rho_ave = sum( zed_fract(:,2).*rho);if density > 0    rho_ave = density;endif energy == 0    error( 'Energy undefined' )endif amu_ave == 0    error( 'Atomic Weight undefined' )endmu = (F_TO_MU * rho_ave * mu) ./ (energy * amu_ave);return