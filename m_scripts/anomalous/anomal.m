function [fp,fpp]=anomal(zed,energy);% ANOMAL% % Usage: [fp,fpp]=anomal(zed,energy);%% Returns the anomalous scattering factors f' and f''% from one of three calculations, according to the setting% of the global ANOMAL_FLAG:%% ANOMAL_FLAG= 0; Cromer and Lieberman (default)% ANOMAL_FLAG= 1; Henke% ANOMAL_FLAG= 2; Kissel and Pratt%% Input:%   zed     =   atomic number%   energy  =   x-ray energy (in eV) (can be a vector)%% Output:%   f'      =   real part of the anomalous scattering factor%   f''     =   imaginary part of the anomalous scattering factor%% See also: FPRIME% References: % D.T. Cromer and D.A. Lieberman J. Chem. Phys. 53, 1891 (1970); Acta% Cryst. 18, 17 (1965); Acta Cryst. A37, 267 (1981).% D.T. Cromer, J. Appl. Cryst. 16, 437 (1983)%% B.L. Henke et al., Atomic Data Nuc. Data Tables 54, 181 (1993)%% L. Kissel et al., Acta Cryst. A51, 271 (1995). % Also http://www-phys.llnl.gov/Research/scattering/index.html% 18-NOV-95 SMB bren@slac.stanford.edu% 5-May-03 SMB Add ANOMAL_FLAG=2 capabilityglobal ANOMAL_FLAGif isempty(ANOMAL_FLAG)	ANOMAL_FLAG=0;endif ANOMAL_FLAG==2,    [fp,fpp]=kissel(zed,energy);% 	[fpp]= kissel(zed,energy);% 	fp=zeros(size(fpp));elseif ANOMAL_FLAG==1,    [fp,fpp]=henke(zed,energy);elseif ANOMAL_FLAG==0    [fp,fpp]=cromer(zed,energy);else	warning('ANOMAL_FLAG out of range')end[m,n]=size(energy);if m>n,	fp=fp(:);	fpp=fpp(:);end