function f=pk_svoigt(x,lam);% f= pk_voigt(x,lam)% actual function to calculate single voigt peak% 5-2-94 SMB (Bren@SLAC.stanford.edu)% 5-14-01 TCH (hufnagel@jhu.edu)% Modified to make "supervoigt" (Kalpha1+Kalpha2)% Important! Assumes that x-values are theta in degreesf=zeros(size(x));delx=x-lam(1);gau= exp(-(delx ./(0.600561*lam(3))).^2);lor= 1+ (delx ./(0.5*lam(3))).^2;f= f+ lam(2) .*((lam(4)./lor)+((1-lam(4)).*gau));delx2=x-(asin(sin(lam(1)*3.14159/180)*(1.544390/1.540562)))*180/pi;gau2= exp(-(delx2 ./(0.600561*lam(3))).^2);lor2= 1+ (delx2 ./(0.5*lam(3))).^2;f2=lam(2) .*((lam(4)./lor2)+((1-lam(4)).*gau2));f=f+0.5.*f2;