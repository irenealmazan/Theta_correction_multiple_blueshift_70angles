function [z,w] = strtoz(s);% STRTOZ% % Usage: [z,w]=strtoz(s);%% Determines the atomic number and composition for each element from the% sample composition string.%% Input:  s = sample composition string, e.g. '2H1O' for water% % Output: z = array of atomic numbers%         w = array of compositions (atoms per composition unit, or atomic % for alloy)%         For s='2H10', z=[1 8] and w=[2 1] except they're column vectors%%% Todd Hufnagel (hufnagel@jhu.edu), 4-30-00% Originally by R. Sermiaa% Comments added, TCH 8-20-93% Element name lookup array integrated into routine, TCH 5-2-00if isstr(s) == 1,  s;  len = max(size(s)); no = 0; i = 0;% Define the element name arrayelements=['H ';'He';...'Li';'Be';'B ';'C ';'N ';'O ';'F ';'Ne';'Na';'Mg';'Al';'Si';'P ';'S ';'Cl';'Ar';'K ';'Ca';'Sc';'Ti';'V ';'Cr';'Mn';'Fe';'Co';'Ni';'Cu';'Zn';'Ga';'Ge';'As';'Se';'Br';'Kr';...'Rb';'Sr';'Y ';'Zr';'Nb';'Mo';'Tc';'Ru';'Rh';'Pd';'Ag';'Cd';'In';'Sn';'Sb';'Te';'I ';'Xe';...'Cs';'Ba';'La';'Ce';'Pr';'Nd';'Pm';'Sm';'Eu';'Gd';'Tb';'Dy';'Ho';'Er';'Tm';'Yb';'Lu';'Hf';'Ta';'W ';'Re';'Os';'Ir';'Pt';'Au';'Hg';'Tl';'Pb';'Bi';'Po';'At';'Rn';...'Fr';'Ra';'Ac';'Th';'Pa';'U ';'Np';'Pu';'Am';'Cm';'Bk';'Cf';'Es';'Fm';'Md';'No';'Lr'];    for j = 1:len;    if ('0' <= s(j) & s(j) <= '9'), no = no*10+abs(s(j))-48; end;    if ('A' <= s(j) & s(j) <= 'Z'), % string      i = i+1; subs(1) = s(j); subs(2) = ' ';      if j ~= len,         if ('a' <= s(j+1) & s(j+1) <= 'z'), subs(2) = s(j+1); end;      end;      k = find(elements(:,1) == subs(1)); l = find(elements(k,2) == subs(2));       z(i) = k(l); if no ~= 0, w(i) = no; no = 0; else w(i) = 1; end;    end;  end;else,  z = s; w = 1;end;z = z(:); w = w(:);