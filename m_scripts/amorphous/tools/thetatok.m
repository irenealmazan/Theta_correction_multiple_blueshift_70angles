function k = thetatok(theta,l_or_e,eflag);% THETATOK Calculate scattering vector magnitude from theta%% Usage: k = thetatok(theta,l_or_e,{,eflag})%% Calculates the magnitude of the scattering vector, given% theta (one-half of the scattering angle) and either the % energy or the wavelength of the radiation used.%% Input:%  theta = array of theta values (degrees), where%          theta is one-half of the scattering angle.%  l_or_e = wavelength or energy. KTOTHETA tries to make an intelligent%           guess as to which it is, according to these rules:%           l_or_e < 100 assumed to be wavelength in %           l_or_e >= 100 assumed to be energy in eV%  eflag = (optional) string, allows you to specify what l_or_e is,%          overriding PROBE and the guesses above:%          'ee' = l_or_e is electron energy%          'ew' = l_or_e is electron wavelength%          'xe' = l_or_e is x-ray energy%          'xw' = l_or_e is x-ray wavelength%   % Output:%  k = array of scattering vector magnitudes. THETATOK can%      return either k=4*pi*sin(theta)/lambda or s=2*sin(theta)/lambda, %      depending on the setting of global PROBE. For PROBE=0 (x-ray%      scattering, which is the default), THETATOK returns k. For PROBE=1 %      (electron scattering), it returns s.%% See also: KTOTHETA, ETOLAMBDA, LAMBDATOE, ELECTRONETOLAMBDA% Todd Hufnagel (hufnagel@jhu.edu) 4-30-00% TCH Added simple error check 05-02-00% 08-May-03 TCH Added PROBE, eflag flags for greater flexibilityglobal PROBEif isempty(PROBE)    PROBE=0;         % X-ray scattering is the defaultendif nargin<3             % eflag not specified    if l_or_e<100       % is l_or_e wavelength or energy?        lambda=l_or_e;  % wavelength    else        switch PROBE    % energy, convert to wavelength            case 0      % x-ray scattering (PROBE=0)                lambda=etolambda(l_or_e);            case 1      % electron scattering (PROBE=1)	            lambda=electronetolambda(l_or_e);            otherwise   % oops                error('Unknown value of global PROBE!')        end    end    else                    % eflag is specified    eflag=lower(eflag(1:2));    switch eflag        case 'ee'       % electron energy	        lambda=electronetolambda(l_or_e);        case 'ew'       % electron wavelength    	        lambda=l_or_e;        case 'xe'       % x-ray energy            lambda=etolambda(l_or_e);        case 'xw'       % x-ray wavelength    	    lambda=l_or_e;        otherwise       % oops            error('Unknown value of eflag! (Allowed values are ''ee'',''ew'',''xe'', and ''xw''.)')    endendswitch PROBE    case 0              % x-ray scattering, return k        k=4*pi*sin(pi/180.*theta)/lambda;    case 1              % electron scattering, return s            k=2*pi*sin(pi/180.*theta)/lambda;    otherwise           % oops        error('Unknown value of global PROBE!')end