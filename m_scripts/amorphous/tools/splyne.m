function yi = splyne(x,y);% SPYLNE - Cubic spline fitting to data%% Usage: yi = splyne(x,y);%% SPLYNE allows the user to fit data to a cubic spline% with an arbitrary number of knots.  SPLYNE plots the % (x,y) data and prompts the user to indicate the desired % knots.  Knots can be removed by pressing the center button% (shift-click on Macintosh). Knot entry is terminated by % pressing the right mouse button (ctrl-click on Macintosh).%% Input:  x,y  = x,y data pairs%% Output: yi = array of values of the spline (x unchanged)%% TCH 4-7-94: Original function% TCH 5-18-94: Modified knot removal to delete closest knot,% eliminated automatic knot selection option, display spline% as knot selection progresses.          button=0;nknots=0;%whitebg('black');h=plot(x,y,'b.');grid;set(gcf,'BackingStore','Off')while button ~=3	xmin=get(gca,'XLim');xmax=xmin(2);xmin(2)=[];	ymin=get(gca,'YLim');ymax=ymin(2);ymin(2)=[];	[buttonx,buttony,button]=ginput(1);	if button == 1		nknots=nknots+1;		knotx(nknots)=buttonx;		knoty(nknots)=buttony; 		plot(x,y,'b.',knotx,knoty,'o');grid 	elseif ((button == 2) & (nknots > 0)) 		xscale=xmax-xmin;		yscale=ymax-ymin;		distance=sqrt(((knotx-buttonx)/xscale).^2+...			((knoty-buttony)/yscale).^2);		[howfar closest]=min(distance);		knotx(closest)=[];		knoty(closest)=[];		nknots=nknots-1;        end	if (nknots >= 2)		clear tempy tempx		tempx=sort(knotx);		for i=1:nknots;			tempy(i)=knoty(find(knotx==tempx(i)));		end		knoty=tempy;		knotx=tempx;			yi = spline(knotx,knoty,x);		plot(x,y,'b.',knotx,knoty,'bo',x,yi,'r-')		eval(['set(gca,''XLim'',[xmin xmax])']);		eval(['set(gca,''YLim'',[ymin ymax])']);		grid	elseif (nknots == 1)		plot(x,y,'b.',knotx,knoty,'bo');grid	else		plot(x,y,'b.');	endendyi = spline(knotx,knoty,x);plot(x,y,'b.',x,yi,'r-',knotx,knoty,'bo');grid