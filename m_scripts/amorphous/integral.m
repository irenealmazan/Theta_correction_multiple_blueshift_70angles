function fac = integral(k,kmin,kmax,icor,coh,inc,atden)% INTEGRAL Normaliztion constant using integral method.% % fac = integral(k,kmin,kmax,icor,coh,inc,atden)%% Input:% 	k			= array of scattering vector magnitudes (inv. Angstroms)% 	kmin, kmax	= the first and last value of k used in normalization.% 	icor		= experimental corrected intensity% 	coh			= independent coherent intensity <ff*>% 	inc			= independent incoherent (Compton) intensity%	atden		= atomic density (atoms/Angstrom^3)%% Output:%	fac        = normalization factor% Todd Hufnagel (hufnagel@jhu.edu), 5-2-00% Originally by Ritva Serimaa% 12-May-03 Eliminate call to TRAPEZ; use built-in TRAPZ insteadj = find(k >= kmin & k <= kmax);y(j)   = (coh(j)+inc(j))./coh(j).*k(j).^2;thenor = trapz(k(j),y(j));y(j)   = icor(j)./coh(j).*k(j).^2;expnor = trapz(k(j),y(j));fac    = (thenor - 2*pi^2*atden)/expnor;