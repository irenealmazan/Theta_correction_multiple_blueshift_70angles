function [mr,rho,atwt] = avgatom(e,s);% AVGATOM Mass absorption coefficient of average atom%% Usage: [murho,rho,atwt]=avgatom(e,s)%% Calculates the mass absorption coefficient of a compositionally % averaged atom given the sample composition. Also returns column vectors% with the density and atomic mass in the formula unit of each component.%% Input:%		e = x-ray energy (eV)%		s = sample string, e.g. '2H1O' for water%% Output%		murho = mass absorption coefficient (mu/rho) (cm^2/g)%		rho   = vector of densities (g/cm^3)%		atwt = vector of amu's in formula unit (g/mol)%% Todd Hufnagel (hufnagel@jhu.edu) 4-30-00% Based on MPR.M by R. Serimaa% Requires: STRTOZ, ABSORB, ATOMDATA[z,w] = strtoz(s);mtot = 0;mr = 0;k = max(size(z));rhov = zeros(k,1); mv = zeros(k,1);for i = 1:k,	[mu,rho(i),ifail]=absorb(z(i),e);	atwt(i)=w(i).*atomdata(z(i));	mr=mr+mu./rho(i).*10^4.*atwt(i);end;mr = mr/sum(atwt);