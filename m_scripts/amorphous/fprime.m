function [fp,fpp] = fprime(energy,s);% FPRIME%% Usage: [fp,fpp] = fprime(energy,s);%% Finds the anomalous scattering factors f' and f''% for a material of arbitrary composition at a single% x-ray energy. The anomalous scattering factors can% come from one of three sources, depending on the setting% of the global ANOMAL_FLAG:%%   0 = Cromer and Lieberman (default)%   1 = Henke%   2 = Kissel and Pratt%% Input:%   energy = a SINGLE x-ray energy (eV)%   s      = formula unit string, e.g. '2H1O' for water%% Output:%  fp, fpp = real and imaginary part of the anomalous dispersion correction%            for each element (vector)%% See also: ANOMAL% References: % D.T. Cromer and D.A. Lieberman J. Chem. Phys. 53, 1891 (1970); Acta% Cryst. 18, 17 (1965); Acta Cryst. A37, 267 (1981).% D.T. Cromer, J. Appl. Cryst. 16, 437 (1983)% B.L. Henke et al., Atomic Data Nuc. Data Tables 54, 181 (1993)% L. Kissel et al., Acta Cryst. A51, 271 (1995). % Also http://www-phys.llnl.gov/Research/scattering/index.html% Todd Hufnagel (hufnagel@jhu.edu) 4-30-00% Originally by R. Serimaa% TCH 6-17-02 Bring in line with other code by using ANOMAL_FLAG% SMB 5-May-03 Replace ANOMAL_FLAG with call to anomal[z,w] = strtoz(s);nz = max(size(z));fp    = zeros(1,nz);fpp = zeros(1,nz);for l = 1:nz,	[fp(l) fpp(l)] = anomal(z(l),energy);end;